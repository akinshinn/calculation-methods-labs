\documentclass{article}
\usepackage[T2A]{fontenc}
\usepackage{epigraph}
\usepackage[english, russian]{babel} % языковой пакет
\usepackage{amsmath,amsfonts,amssymb} %математика
\usepackage{mathtools}
\usepackage[oglav,spisok,boldsect,eqwhole,figwhole,hyperref,hyperprint,remarks,greekit]{../../style/fn2kursstyle}
\usepackage[utf8]{inputenc}
\usepackage[]{tkz-euclide}
\usepackage{algpseudocode}
\usepackage{pgfplots}
\usepackage{tikz-3dplot}
\usepackage[oglav,spisok,boldsect,eqwhole,figwhole,hyperref,hyperprint,remarks,greekit]{./style/fn2kursstyle}
\usepackage{multirow}
\usepackage{supertabular}
\usepackage{multicol}
\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{float}
\usepackage{graphicx}
\pgfplotsset{compat=1.9}
\usepackage[svgnames]{pstricks}
\usepackage{pst-solides3d} 
\usepackage{multirow}
\usepackage{hhline}
\usepackage{slashbox}
\usepackage{pdflscape}
\usepackage{array} 
\graphicspath{{../../style/}{../}}

  



\newcommand{\cond}{\mathop{\mathrm{cond}}\nolimits}
\newcommand{\rank}{\mathop{\mathrm{rank}}\nolimits}
% Переопределение команды \vec, чтобы векторы печатались полужирным курсивом
\renewcommand{\vec}[1]{\text{\mathversion{bold}${#1}$}}%{\bi{#1}}
\newcommand\thh[1]{\text{\mathversion{bold}${#1}$}}
%Переопределение команды нумерации перечней: точки заменяются на скобки
\renewcommand{\labelenumi}{\theenumi)}
\newtheorem{theorem}{Теорема}
\newtheorem{define}{Определение}
\tdplotsetmaincoords{60}{115}
\pgfplotsset{compat=newest}

\title{Методы решения нелинейных уравнений}
\author{Н.\,О.~Акиньшин}
\group{ФН2-51Б}
\date{2024}
\supervisor{А.\,С.~Джагарян}



\begin{document}
    \maketitle
    \newpage
    \tableofcontents
    \newpage

    \section{Контрольные вопросы}
    \begin{enumerate}
        \item Можно ли использовать методы бисекции и Ньютона
        для нахождения кратных корней уравнения $f(x) = 0$ (т. е.
        тех, в которых одна или несколько первых производных
        функций $f(x)$ равны нулю)? Обоснуйте ответ.
        \newline 
        {\bfseries Ответ. } 
        Рассмотрим метод бисекции. 
        Если корень имеет четную кратность, то метод бисекции окажется неприменим, т.к. 
        $f(x_1)f(x_2) > 0$. То есть на границах локализации значения функции имеют один знак. 
        Однако если корень имеет нечётную кратность, то такое свойство не выполняется, поэтому можно использовать метод бисекции. 

        Рассмотрим метод Ньютона:
        \begin{equation*}
            x^{k+1} = x^k - \frac{f(x^k)}{f'(x^k)}.
        \end{equation*}
        Пусть корень  уравнения $f(x) = 0$ кратности $m$ в точке $x_0$, т.е. 
        \begin{equation*}
            f'(x_0) = f''(x_0) = \ldots = f^{(m-1)}(x_0) = 0
        \end{equation*}
        Тогда при $x^k \to x_0$
        \begin{equation*}
            x^{k+1} = x_0 - \lim\limits_{x^k \to x_0} \frac{f(x^k)}{f'(x^k)}
        \end{equation*}
        Рассмотрим отдельно 
        \begin{equation*}
            \lim\limits_{x^k \to x_0} \frac{f(x^k)}{f'(x^k)} = \lim\limits_{x^k \to x_0} \frac{f'(x^k)}{f''(x^k)} 
            = \ldots = \lim\limits_{x^k \to x_0} \frac{f^{(m-1)}(x^k)}{f^{(m)}(x^k)} = 0
        \end{equation*}
        Значит если $x^k \approx x_0$, то $x^{(k+1)} \to x_0$ при $k \to \infty$.
        \item При каких условиях можно применять метод Ньютона для
        поиска корней уравнения \mbox{$f(x) = 0, \  x \in [a, b]$}? При каких ограничениях
        на функцию $f(x)$ метод Ньютона обладает квадратичной
        скоростью сходимости? В каких случаях можно применять
        метод Ньютона для решения систем нелинейных уравне-
        ний?
        \newline 
        {\bfseries Ответ. } 
        Теорема. Пусть функция $F(x)$ липшиц-непрерывна с постоянной $q \in (0;1)$ на отрезке $[c- \delta;c+\delta]$ т.е. верно $\forall x', x'' \in [c- \delta;c+\delta]\, |F(x')-F(x'')| \le q|x'-x''|$ и верно $|F(c)-c \le (1-q)\delta|$ Тогда уравнение $x=F(x)$ имеет единственное решение $x_*$
	
	
	Следствие. Если вместо условия липшиц-непрерывности функции $F(x)$ верно неравенство $|F'(x)| \le q < 1$ на $[c- \delta;c+\delta]$, то уравнение $x=F(x)$ имеет единственное решение $x_*$.
	
	
	Метод Ньютона для решения уравнения можно применять, если метод сходиться. Рассмотрим условия, при которых метод сходиться. Метод Ньютона имеет вид $x^{k+1} = x^k - f(x^k)/f'(x^k)$. $F(x) = x- f(x)/f'(x)$. Тогда $F'(x)=f*f''/(f')^2$. Пусть на отрезке $[a, b]$ выполнено $|f'(x)|\ge m >0, \, |f''(x)| \le M$. Тогда существует $\varepsilon$ окрестность корня $x_*$, что если начально приближение лежит в этой окрестности, то итерационный процесс сходится к корню т.к верна оценка $|F'(x)| = |\frac{ff''}{(f')^2}| \le \frac{|f|}{m^2} M$. Из непрерывности функции $f(x)$ следует, что для любого $q$ найдется окрестность корня, в которой справедливо $|f(x)| \le qm^2/M$. Следовательно $|F'(x)| =q \le 1$ т.е выполнены условия следствия поэтому метод Ньютона сходится при выборе начального приближения из соответствующей окрестности.
	
	
	Оценим погрешность метода Ньютона. По формуле Тейлора.
	\[
	f(x_*) = f(x^k) + f'(x^k)(x_*-x^k) + \frac{1}{2}f''(\xi)(x^k-x_*)^2=0
	\] 
	Тогда 
	\[
	x^{k+1} = x^k - f(x^k)/f'(x^k) = x^k - \frac{f(x^k) - f(x_*)}{f'(x^k)} = x_* + \frac{1}{2}\frac{f''(\xi)}{f'(x^k)(x^k-x_*)^2}
	\]
	
	Следовательно верно $|x^{k+1}-x_*| \le \frac{M}{2m} |x^k-x_*|^2$. Таким образом Метод Ньютона имеет квадратичную скорость сходимости, если $f'(x) \neq 0$. В противном случае скорость сходимости снижается до линейной.
	
	
	Метод Ньютона для решения системы нелинейных уравнений имеет вид $F'(x^k)(x^{k+1}-x^k)+F(x^k)=0$. Таким образом аналогично одномерному случаю нужно чтобы существовала обратная матрица к $F'(x^k)$.
        \item Каким образом можно найти начальное приближение?
         \newline 
        {\bfseries Ответ. } 
        Начальное приближение корня можно найти используя метод вилки для локализации корней. 
        Тогда для каждого корня $x_k^*$ будут найдены границы $[x_k^{(1)},\, x_k^{(2)}]$.
        И начальное приближение $x_k^{(0)}$ можно выбирать как $x_k^{(0)} = \dfrac{x_k^{(2)} + x_k^{(1)}}{2}$.
        Этот способ требует некоторого количества итераций. 
        
        Если у уравнения $f(x) = 0$ имеется 1 корень нечетной кратности на отрезке $[a,\,b]$, то 
        начальное приближение можно найти за $O(1)$, используя метод хорд:
        \begin{equation*}
            x^{(0)} = \frac{f(a) \cdot b - f(b) \cdot a}{f(a) - f(b)}
        \end{equation*} 
        Данная точка получена путём пересечения прямой, соединяющей точки $(a, f(a))$ и $(b, f(b))$.
        \item Можно ли использовать метод Ньютона для решения
        СЛАУ?
        \newline 
        {\bfseries Ответ. } 
        Метод Ньютона для решения системы нелинейных уравнений имеет вид $F'(x^k)(x^{k+1}-x^k)+F(x^k)=0$. Пусть СЛАУ имеет вид $Ax = f$. Тогда $F(x)=Ax-f$. Заметим, что $F'(x) = A$ в силу линейности. Тогда метод Ньютона имеет вид $A(x^{k+1}-x^k) + Ax^k-f$ т.е $Ax^{k+1}=f$ т.е решение СЛАУ на прямую каким либо методом и с помощью метода Ньютона это одно и то же. Следовательно особого смысла использовать метод Ньютона при решении СЛАУ нет.
        \item Предложите альтернативный критерий окончания итераций в методе 
        бисекции, в котором учитывалась бы 
        возможность попадания очередного приближения в очень малую
        
        окрестность корня уравнения.
        \newline 
        {\bfseries Ответ. } 
        Новый критерий будет выглядеть следующим образом: 
        
            $|x^{k+1} - x^k| < \varepsilon$ {\ttfamily OR } $|f(x^{k+1})| < \varepsilon_0$ {\ttfamily OR } $iters < MAXITER$
        
        \item Предложите различные варианты модификаций метода
        Ньютона. Укажите их достоинства и недостатки.
        \newline 
        {\bfseries Ответ. } 
        Рассмотрим различные модификации метода Ньютона в одномерном случаи.
	1) Для вычисления производной функции в точке требуется 2 вычисления значения функции, если функция сложная, то имеет смысл в методе Ньютона выбрать точку и на каждой итерации производную считать в ней. Также данный способ хорош тем, что в процессе метода не получиться выйти за исследуемую область т.к. производная берется на каждой итерации одна и та же
	2) Также можно рассмотреть следующую модификацию имеющую 3ей порядок сходимости 
	\[
	x^{k+1} = x^k - f(x^k)/f'(x^k)- \frac{f(x^k-f(x^k)f'(x^k)^{-1})}{f'(x^k)}
	\]
	
	
	Модификации метода Ньютона в многомерном случаи.
	Классический метод Ньютона имеет вид $F'(x^k)(x^{k+1}-x^k)+F(x^k)=0$
	1)Аналогично одномерному случаи можно зафиксировать точку в которой считается матрица Якоби.
	
	2)Можно ввести параметр в метод Ньютона т.е рассмотреть алгоритм $F'(x^k)\frac{(x^{k+1}-x^k)}{\tau_{k+1}}+F(x^k)=0$
	3) Кроме того в процессе метода Ньютона требуется решать СЛАУ, для решения можно применять различные алгоритмы: Гаусса, QR, методом простой итерации, Якоби, Зейделем, релаксацией.
        \item Предложите алгоритм для исключения зацикливания метода Ньютона и выхода за пределы области поиска решения?
        \newline 
        {\bfseries Ответ. } 
        Заметим, что зацикливание метода Ньютона происходит означает, что алгоритм выдаёт одну и ту же 
        последовательность точек $x^k$ с некоторым периодом. То есть 
        \begin{equation*}
            x^{k+T+1} = x^{k+1} = x^k - \frac{f(x^k)}{f'(x^k)},
        \end{equation*}
        где $T \in \mathbb{N}$ -- период. Это может происходить только в некоторых точках (не более, чем счетном множестве точек) области 
        определения функции $f(x)$, в силу того, что $\{x^k\}_{k=1}^\infty$ -- счётно. 
        Для борьбы с зацикливанием в формуле следующего приближения $x^{k+1}$ можно всегда добавлять 
        некоторое малое число $\varepsilon_0$.
        Тогда формула преобразуется 
        \begin{equation*}
            x^{k+1} = x^k - \frac{f(x^k)}{f'(x^k)} +\varepsilon_0 ,
        \end{equation*}
        Из-за этого добавления алгоритм не перестанет сходиться (может увеличиться число итераций) для тех уравнений, в которых нет зацикливания.

        Рассмотрим выход за границу поиска решений. 
        \begin{equation*}
            x^{k+1} = x^k - \frac{f(x^k)}{f'(x^k)} \not \in [a,\, b]
        \end{equation*}
        Тогда в таких случаях будет задавать $x^{k+1}$ в некоторой малой окрестности границ поиска решений, то есть 
        \begin{algorithmic}[1]
            \If {$x^{k+1} < a$}
            \State  $x^{k+1} = a + \varepsilon_0$
            \EndIf
            \If {$x^{k+1} > b$}
            \State  $x^{k+1} = b - \varepsilon_0$
            \EndIf
            % \State prod=0, $\alpha=0, \, \beta=0$, koren=0, tmp1=0, tmp2=0
            % \For{k = 1; k < size - 1; k++}
            %     \For{l = k+1; l < size; l++}
            %         \State $koren = \sqrt{Matrix[l][k - 1] * Matrix[l][k - 1] + Matrix[k][k - 1] * Matrix[k][k - 1]}$
            %         \State $\alpha = \frac{Matrix[k][k - 1]}{koren}$
            %         \State $\beta = \frac{Matrix[l][k - 1]}{koren}$
            %         \For{index = k-1; index < size; index++}
            %             \State tmp1 = alpha * Matrix[k][index] + beta * Matrix[l][index]
            %             \State tmp2 = alpha * Matrix[l][index] - beta * Matrix[k][index]
            %             \State Matrix[k][index] = tmp1
            %             \State Matrix[l][index] = tmp2
                        
            %         \EndFor
            %         \For{index = 0; index < size; index++}
            %             \State tmp1 = alpha * Matrix[index][k] + beta * Matrix[index][l]
            %             \State tmp2 = alpha * Matrix[index][l] - beta * Matrix[index][k]
            %             \State Matrix[index][k] = tmp1
            %             \State Matrix[index][l] = tmp2
            %         \EndFor
            %     \EndFor
            % \EndFor
        \end{algorithmic}
        Тогда итоговый алгоритм имеет вид
        \begin{algorithmic}[1]
            \While{$(|x^k - x^{k+1}| > \varepsilon)$ and $(iterations < MAXITER)$}
            \State $iterations++$;
            \State $x^k = x^{k+1}$
            \State $x^{k+1} = x^k - \frac{f(x^k)}{f'(x^k)} + \varepsilon_0$
            \If {$x^{k+1} < a$}
            \State  $x^{k+1} = a + \varepsilon_0$
            \EndIf
            \If {$x^{k+1} > b$}
            \State  $x^{k+1} = b - \varepsilon_0$
            \EndIf
            \EndWhile
        \end{algorithmic}
    \end{enumerate}

    \section{Результаты}
    \begin{table}[H]
        \centering
        \caption{Исследование скорости сходимости методом Ньютона примера из варианта c точной производной}
        \begin{tabular}{|c|c|c|c|}
            \hline
            $n$ & $|x^{k+1} - x^k|$ & $ |x_k - x*|$ & Скорость сходимости $p \geqslant \dfrac{\ln | \frac{x^{k+1}-x^*}{x^k - x^*} |}{\ln |\frac{x^k -x^*}{x^{k-1} - x^*}|}$ \\
            \hline 
            1 & 0.156502 & 0.328702 & -inf \\ \hline
            2 & 0.161741 & 0.166961 & 1.73949 \\ \hline
            3 & 0.107013 & 0.0599483 & 1.5121 \\ \hline
            4 & 0.0473819 & 0.0125664 & 1.52542 \\ \hline
            5 & 0.0117632 & 0.000803224 & 1.76014 \\ \hline
            6 & 0.000799756 & 3.46757e-06 & 1.97996 \\ \hline
            7 & 3.71678e-06 & 2.49206e-07 & 0.483534 \\ \hline
            8 & 8.02607e-11 & 2.49287e-07 & -0.000122302 \\ \hline

        \end{tabular}
    \end{table}
    \begin{table}[H]
        \centering
        \caption{Исследование скорости сходимости методом Ньютона примера из варианта c численной производной}
        \begin{tabular}{|c|c|c|c|}
            \hline
            $n$ & $|x^{k+1} - x^k|$ & $ |x_k - x*|$ & Скорость сходимости $p \geqslant \dfrac{\ln | \frac{x^{k+1}-x^*}{x^k - x^*} |}{\ln |\frac{x^k -x^*}{x^{k-1} - x^*}|}$ \\
            \hline 
            1 & 0.156502 & 0.328702 & -inf \\ \hline
            2 & 0.161741 & 0.166961 & 1.73949 \\ \hline
            3 & 0.107013 & 0.0599483 & 1.5121 \\ \hline
            4 & 0.0473819 & 0.0125664 & 1.52542 \\ \hline
            5 & 0.0117632 & 0.000803224 & 1.76014 \\ \hline
            6 & 0.000799757 & 3.46749e-06 & 1.97997 \\ \hline
            7 & 3.7167e-06 & 2.49206e-07 & 0.483528 \\ \hline
            8 & 8.04039e-11 & 2.49287e-07 & -0.000122522 \\ \hline

        \end{tabular}
    \end{table}
    \begin{table}[H]
        \centering
        \caption{Исследование скорости сходимости методом секущих примера из варианта}
        \begin{tabular}{|c|c|c|c|}
            \hline
            $n$ & $|x^{k+1} - x^k|$ & $ |x_k - x*|$ & Скорость сходимости $p \geqslant \dfrac{\ln | \frac{x^{k+1}-x^*}{x^k - x^*} |}{\ln |\frac{x^k -x^*}{x^{k-1} - x^*}|}$ \\
            \hline 
            1 & 0.0654559 & 0.169748 & 0.450394 \\ \hline
            2 & 0.0922672 & 0.0774809 & 2.40476 \\ \hline
            3 & 0.0443854 & 0.0330955 & 1.0846 \\ \hline
            4 & 0.0238522 & 0.00924322 & 1.49947 \\ \hline
            5 & 0.00780801 & 0.00143522 & 1.46026 \\ \hline
            6 & 0.00136277 & 7.24451e-05 & 1.60329 \\ \hline
            7 & 7.20933e-05 & 3.51844e-07 & 1.78398 \\ \hline
            8 & 6.00877e-07 & 2.49033e-07 & 0.0648729 \\ \hline
            9 & 2.53782e-10 & 2.49287e-07 & -0.00294716 \\ \hline
        \end{tabular}
    \end{table}
\end{document}
